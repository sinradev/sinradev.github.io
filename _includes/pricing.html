<div class="pricing-page">
  <!-- Hero Section -->
  <section class="pricing-hero">
    <div class="container">
      <div class="hero-content">
        <h1>{{ site.data[site.active_lang].strings.pricing.title }}</h1>
        <p class="hero-subtitle">{{ site.data[site.active_lang].strings.pricing.heading }}</p>
        <a href="https://app.sinra.dev/users/sign_up" class="discount-badge">
          <span>{{ site.data[site.active_lang].strings.pricing.discount_badge }}</span>
        </a>
      </div>
    </div>
  </section>

  <!-- Pricing Plans -->
  <section class="pricing-plans">
    <div class="container">
      <div class="plans-grid">
        {% for plan in site.data[site.active_lang].pricing %}
          {% assign promo = site.data[page.lang].promotion %}
          {% assign today = site.time | date: "%Y-%m-%d" %}
          {% assign is_black_friday_active = false %}
          {% if promo.end_date %}
            {% if today <= promo.end_date %}
              {% assign is_black_friday_active = true %}
            {% endif %}
          {% endif %}

          <div class="plan-card" style="position: relative;">
            {% assign plan_recommended = false %}
            {% for tier in plan.pricing_tiers %}
              {% if tier.recommended %}
                {% assign plan_recommended = true %}
              {% endif %}
            {% endfor %}

            {% if plan_recommended and plan.pricing_tiers.size > 1 %}
              <div class="recommended-badge">
                <span>{{ site.data[site.active_lang].strings.pricing.recommended }}</span>
              </div>
            {% endif %}

            <div class="plan-header">
              <h3 class="plan-name">{{ plan.name }}</h3>

              <!-- Pricing Tiers Container -->
              <div class="pricing-tiers">
                {% for tier in plan.pricing_tiers %}
                  <div class="pricing-frame {% if tier.recommended %}emphasized{% endif %}">
                    <div class="tier-period">{{ tier.period }}</div>

                    {% if tier.plan_type == "coming_soon" %}
                      <!-- Coming Soon: No price display -->
                    {% elsif tier.has_black_friday and is_black_friday_active %}
                      <!-- Black Friday Pricing -->
                      <div class="plan-price-black-friday">
                        <span class="original-price">{{ tier.currency }}{{ tier.original_price }}</span>
                        <span class="struck-price">{{ tier.currency }}{{ tier.struck_price }}</span>
                        <div class="plan-price">
                          <span class="currency">{{ tier.currency }}</span>
                          <span class="amount">{{ tier.black_friday_price }}</span>
                          <span class="period">{{ tier.billing }}</span>
                        </div>
                        {% if tier.promo_code %}
                          <div class="promo-code">
                            <span class="promo-label">{{ site.data[site.active_lang].strings.pricing.promo_code }}</span>
                            <span class="promo-code-value">{{ tier.promo_code }}</span>
                          </div>
                        {% endif %}
                      </div>
                    {% elsif tier.original_price %}
                      <!-- Regular Discount Display -->
                      <div class="plan-price-with-discount">
                        <span class="original-price">{{ tier.currency }}{{ tier.original_price }}</span>
                        <div class="plan-price">
                          <span class="currency">{{ tier.currency }}</span>
                          <span class="amount">{{ tier.price }}</span>
                          <span class="period">{{ tier.billing }}</span>
                        </div>
                      </div>
                    {% else %}
                      <!-- Standard Pricing -->
                      <div class="plan-price">
                        <span class="currency">{{ tier.currency }}</span>
                        <span class="amount">{{ tier.price }}</span>
                        <span class="period">{{ tier.billing }}</span>
                      </div>
                    {% endif %}
                  </div>
                {% endfor %}
              </div>
            </div>

            <div class="plan-features">
              {% for feature in plan.features %}
                <div class="feature-item {% if feature.highlight %}highlighted{% endif %}">
                  <div class="feature-icon">
                    {% if feature.highlight %}
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" fill="currentColor"/>
                      </svg>
                    {% else %}
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="2" fill="currentColor"/>
                      </svg>
                    {% endif %}
                  </div>
                  <span class="feature-text">{{ feature.text }}</span>
                </div>
              {% endfor %}
            </div>

            {% if plan.call_to_action %}
              <div class="plan-cta">
                {% if plan.call_to_action.badge_type == "coming_soon" %}
                  <div class="cta-badge coming-soon">
                    {{ plan.call_to_action.text }}
                  </div>
                {% else %}
                  <a href="{{ plan.call_to_action.link }}" class="btn {% if plan_recommended %}btn-primary{% else %}btn-secondary{% endif %}">
                    {{ plan.call_to_action.text }}
                  </a>
                {% endif %}
              </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  {% if site.data[site.active_lang].pricing_faq %}
    <section class="pricing-faq">
      <div class="container">
        <h2>{{ site.data[site.active_lang].strings.pricing.pricing_faq }}</h2>
        <div class="faq-grid">
          {% for item in site.data[site.active_lang].pricing_faq %}
            <div class="faq-item">
              <div class="faq-question">
                <h3>{{ item.question }}</h3>
                <svg class="faq-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M19 9l-7 7-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <div class="faq-answer">
                <p>{{ item.answer }}</p>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </section>
  {% endif %}

  <!-- CTA Section -->
  <section class="pricing-cta-section">
    <div class="container">
      <div class="cta-content">
        <h2>{{ site.data[site.active_lang].strings.pricing.ready_to_start }}</h2>
        <p>{{ site.data[site.active_lang].strings.pricing.ready_to_start_desc }}</p>
        <div class="cta-buttons">
          <a href="https://app.sinra.dev/users/sign_up" class="btn btn-primary">
            {{ site.data[site.active_lang].strings.pricing.start_free_trial }}
          </a>
          <a href="/contact" class="btn btn-secondary">
            {{ site.data[site.active_lang].strings.pricing.contact_sales }}
          </a>
        </div>
      </div>
    </div>
  </section>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    // FAQ Toggle
    const faqItems = document.querySelectorAll('.faq-item');
    faqItems.forEach(item => {
      const question = item.querySelector('.faq-question');
      const answer = item.querySelector('.faq-answer');

      question.addEventListener('click', () => {
        const isOpen = item.classList.contains('open');

        // Close all other items
        faqItems.forEach(otherItem => {
          otherItem.classList.remove('open');
        });

        // Toggle current item
        if (!isOpen) {
          item.classList.add('open');
        }
      });
    });

    // Email decoding
    var oC = document.getElementsByClassName("courriel");
    var i;
    for (i = 0; i < oC.length; i++) {
      var sC = oC[i].getAttribute("data-courriel");
      sC = sC.replace("point", ".");
      sC = sC.replace("arobas", "@");
      oC[i].setAttribute("href", "mailto:" + sC);
      oC[i].innerHTML = sC;
    }
  });
</script>
